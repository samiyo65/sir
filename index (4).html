<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Goods Received Note (GRN)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <meta charset="UTF-8" />
  <title>PDF Header</title>
  <style>
    body { margin: 20px; color: #333; font-family: Arial, sans-serif; }
    
    .signature-space { height: 60px; border-bottom: 1px solid #000; margin-top: 10px; }
    
    /* Condensed Print Layout */
    @media print {
      body { font-size: 10pt; line-height: 1.4; }
      .container { max-width: 100%; padding: 0; }
      
     
      
      .table { width: 100%; font-size: 10pt; border:}
      .table th, .table td { padding: 2px; text-align: center; }
      .table-responsive { overflow: visible; }
      .form-label { font-weight: bold; font-size: 9pt; }
      .form-control { font-size: 9pt; padding: 4px; }
      .d-flex { display: none !important; }
       button, #exportDropdown { display: none !important; }
      .mb-4, .mb-3, .mb-5 { margin-bottom: 0 !important; }
      .signature-space { margin-top: 5px; }
      .signature-space { margin-top: 5px; }
      
      /* Make fields side by side */
      .side-by-side { display: flex; justify-content: space-between; }
      .side-by-side .col-md-6 { width: 48%; }
      .side-by-side label { font-size: 9pt; font-weight: bold; }

      /* Make signature section side by side */
      .signature-section { display: flex; justify-content: space-between;   margin-top: 50px;}
      .signature-section .col-md-6 { width: 4%; }
    
      
    }

    header {
      display: flex;
      align-items: center;
      background-color: #f4f4f4;
      padding: 0px 0px;
      border-bottom: 3px solid #ccc;
    }

    .logo img {
      height: 80px;
      margin-right: 15px;
      width: 200px;      /* Set the logo width */
      height: 75;     /* Maintain aspect ratio */
    }

    .header-text {
      display: flex;
      flex-direction: column;
      justify-content: center;
      position: absolute;
      left: 50%;
      width: 100%;
      transform: translateX(-50%);
      text-align: center;
      max-width: 1500x;
    }

    .header-line {
      font-size: 24px;
      font-weight: bold;
      line-height: 1.3;
    }

    .english-title {
      color: green;
    }

    .amharic-title {
      color: orange;
    }
      h1 {
    margin-top: 10px;
    margin-bottom: 50px;
    width: 5px%;
    max-width: 1500x;
    align-items: center;
    text-decoration: underline;
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    line-height: 1;
      
      }
    h2 {
    margin-top: 10px;
    margin-bottom: 15px;
    width: 5px%;
  
    line-height: 1
    flex-direction: column;
    justify-content: center;
    font-size: 20px;
    text-align: left;
    text-decoration: underline;
      }
  </style>
</head>
<body>

  <header>
    <div class="logo">
      <img src="data:image/png;base64,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" alt="My Logo" class="logo">
    </div>
    <div class="header-text">
      <div class="header-line amharic-title">የኢትዮጵያ ኤሌክትሪክ አገልግሎት</div>
      <div class="header-line english-title">Ethiopian Electric Utility</div>
    </div>
  </header>
    <h1>Goods Received Note(GRN)</h1>
    <div class="container">
    <!-- Header with logos -->
    <div class="row align-items-center text-center mb-3">
      
     
      
    </div>

    <!-- GRN Info -->
    <div class="row row-cols-2 g-3 mb-3">
      <div>
        <label for="grnNo" class="form-label">GRN No:</label>
        <input type="text" id="grnNo" class="form-control" placeholder="Auto-generated" readonly>
      </div>
      <div>
        <label for="date" class="form-label">Date:</label>
        <input type="text" id="date" class="form-control" placeholder="Auto-filled" readonly>
      </div>
      <div>
        <label for="supplier" class="form-label">Supplier Dep't:</label>
        <input type="text" id="supplier" class="form-control">
      </div>
      <div>
        <label for="vendorName" class="form-label">Receiver Name:</label>
        <input type="text" id="vendorName" class="form-control">
      </div>
      <div>
        <label for="vendorNo" class="form-label">Vendor No:</label>
        <input type="text" id="vendorNo" class="form-control">
      </div>
      <div>
        <label for="contractNo" class="form-label">Contract No:</label>
        <input type="text" id="contractNo" class="form-control">
      </div>
      <div>
        <label for="Address" class="form-label">Specific Area/Address:</label>
        <input type="text" id="Address" class="form-control">
      </div>
      
      
      
      
      <div>
        <label for="projectNo" class="form-label">Project No:</label>
        <input type="text" id="projectNo" class="form-control">
      </div>
      
    </div>

    <!-- Item List -->
 
    <h2><div class="section-title">Item List</div></h2>
    <div class="table-responsive mb-3">
      <table class="table table-bordered table-sm" id="itemTable">
        <thead class="table-light">
          <tr>
            <th style="width: 3%;">#</th>
            <th style="width: 12%;">Material No</th>
            <th style="width: 38%;">Item Description</th>
            <th style="width: 10%;">Quantity</th>
            <th style="width: 6%;">Unit</th>
            <th style="width: 11%;">Condition</th>
            <th style="width: 20;">Remarks</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td><input type="text" class="form-control"></td>
            <td><input type="text" class="form-control"></td>
            <td><input type="text" class="form-control"></td>
            <td><input type="text" class="form-control"></td>
            <td><input type="text" class="form-control"></td>
          </tr>
        </tbody>
      </table>
    </div>
    <button class="btn btn-outline-primary mb-4" onclick="addRow()">+ Add Row</button>

    <!-- Signatures -->
    <div class="row row-cols-2 g-3 mb-4">
      <div>
        <label for="submittedBy" class="form-label">Submitted By (Name):</label>
        <input type="text" id="submittedBy" class="form-control">
        <div class="signature-space"></div>
        <div class="signature-line">Signature</div>
      </div>
      <div>
        <label for="receivedBy" class="form-label">Received By (Name):</label>
        <input type="text" id="receivedBy" class="form-control">
        <div class="signature-space"></div>
        <div class="signature-line">Signature</div>
      </div>
    </div>

    <!-- Buttons -->
    <div class="d-flex flex-wrap gap-2 mb-5">
      <button class="btn btn-secondary" onclick="window.print()">Print Preview</button>
      <select id="exportDropdown" class="form-select w-auto">
        <option value="">Export As...</option>
        <option value="pdf">PDF</option>
        <option value="doc">Word</option>
      </select>
      <button class="btn btn-info" onclick="handleExport()">Export</button>
      <button class="btn btn-success" onclick="submitGRN()">Submit</button>
    </div>
  </div>

  <script>
    const { jsPDF } = window.jspdf;

    function addRow() {
      const table = document.getElementById('itemTable').getElementsByTagName('tbody')[0];
      const rowCount = table.rows.length;
      const row = table.insertRow();
      row.innerHTML = `
        <td>${rowCount + 1}</td>
        <td><input type="text" class="form-control"></td>
        <td><input type="text" class="form-control"></td>
        <td><input type="text" class="form-control"></td>
        <td><input type="text" class="form-control"></td>
        <td><input type="text" class="form-control"></td>
      `;
    }

    function handleExport() {
      const format = document.getElementById('exportDropdown').value;
      if (format === 'pdf') {
        const doc = new jsPDF();
        doc.html(document.body, {
          callback: function (pdf) {
            pdf.save('GRN.pdf');
          },
          x: 10,
          y: 10,
          html2canvas: { scale: 0.5 }
        });
      } else if (format === 'doc') {
        alert("Word export not supported directly in browser.");
      } else {
        alert("Please select a format to export.");
      }
    }

    function generateGRNNumber() {
      const now = new Date();
      return `GRN-${now.getFullYear()}${(now.getMonth()+1).toString().padStart(2, '0')}${now.getDate().toString().padStart(2, '0')}-${Math.floor(1000 + Math.random() * 9000)}`;
    }

    function submitGRN() {
      const grnNumber = generateGRNNumber();
      document.getElementById('grnNo').value = grnNumber;
      const dateValue = new Date().toLocaleDateString();
      document.getElementById('date').value = dateValue;

      const formData = {
        grnNo: grnNumber,
        date: dateValue,
        supplier: document.getElementById('supplier').value,
        vendorNo: document.getElementById('vendorNo').value,
        projectNo: document.getElementById('projectNo').value,
        contractNo: document.getElementById('contractNo').value,
        submittedBy: document.getElementById('submittedBy').value,
        receivedBy: document.getElementById('receivedBy').value,
        items: []
      };

      const rows = document.getElementById('itemTable').getElementsByTagName('tbody')[0].rows;
      for (let row of rows) {
        const cells = row.querySelectorAll('td input');
        formData.items.push({
          materialNo: cells[0].value,
          description: cells[1].value,
          quantity: cells[2].value,
          unit: cells[3].value,
          remarks: cells[4].value
        });
      }

      localStorage.setItem(`GRN-${grnNumber}`, JSON.stringify(formData));
      alert("GRN submitted and saved locally!\nGRN No: " + grnNumber);
    }

    window.onload = function () {
      document.getElementById('date').value = new Date().toLocaleDateString();
    }
  </script>
</body>
</html>
